
# syntax=docker/dockerfile:1
FROM python:3.12-slim as build
WORKDIR /app
COPY . .
RUN pip install --no-cache-dir -r requirements.txt -t /app/site

FROM gcr.io/distroless/python3-debian12
WORKDIR /app
COPY --from=build /app /app
USER 65532:65532
ENV PYTHONPATH=/app/site
ENV UVICORN_WORKERS=2
EXPOSE 8080
ENTRYPOINT ["python","-m","uvicorn","app:app","--host","0.0.0.0","--port","8080"]
